<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Gerenciar Bens</title>
    <h:outputStylesheet name="primefaces/saga/theme.css" library="primefaces" />
</h:head>
<h:body>
    <div class="card">
        <p:menubar>
             <p:menuitem value="Gerenciar Bens" url="#{request.contextPath}/listaBens.xhtml" icon="pi pi-box"/>
             <p:menuitem value="Gerenciar Tipos de Produto" url="#{request.contextPath}/listaTipos.xhtml" icon="pi pi-tags"/>
        </p:menubar>
    </div>
    <h:form id="formBens">
        <p:growl id="messages" showDetail="true" />

        <p:panel header="Novo/Editar Bem" style="margin-bottom:20px;">
            <p:panelGrid columns="4" layout="grid" styleClass="ui-panelgrid-blank">

                <p:outputLabel for="nome" value="Nome do Produto:"/>
                <p:inputText id="nome" value="#{bemBean.bem.nomeProduto}" required="true" label="Nome do Produto"/>

                <p:outputLabel for="tipoProduto" value="Tipo de Produto:"/>
                <p:selectOneMenu id="tipoProduto" value="#{bemBean.bem.tipoProduto}" required="true" converter="omnifaces.SelectItemsConverter">
                    <f:selectItem itemLabel="Selecione..." noSelectionOption="true" />
                    <f:selectItems value="#{bemBean.tiposDeProduto}" var="tipo" itemValue="#{tipo}" itemLabel="#{tipo.nome}"/>
                </p:selectOneMenu>

                <p:outputLabel for="preco" value="Preço de Compra (R$):"/>
                <p:inputNumber id="preco" value="#{bemBean.bem.precoCompra}" symbol="R$ " decimalSeparator="," thousandSeparator="." decimalPlaces="2" required="true"/>

                <p:outputLabel for="dataCompra" value="Data da Compra:"/>
                <p:calendar id="dataCompra" value="#{bemBean.bem.dataCompra}" pattern="dd/MM/yyyy" mask="true" required="true"/>

                <p:outputLabel for="vidaUtil" value="Vida Útil (anos):"/>
                <p:spinner id="vidaUtil" value="#{bemBean.bem.vidaUtilAnos}" min="1" required="true"/>

                <p:outputLabel for="valorResidual" value="Valor Residual (R$):"/>
                <p:inputNumber id="valorResidual" value="#{bemBean.bem.valorResidual}" symbol="R$ " decimalSeparator="," thousandSeparator="." decimalPlaces="2"/>

            </p:panelGrid>

            <p:commandButton value="Salvar" actionListener="#{bemBean.salvar}" update="formBens:tabelaBens formBens:messages @form" style="margin-top: 10px;"/>
        </p:panel>
        
        <p:panel header="Pesquisar Bens" style="margin-bottom:20px;">
            <p:panelGrid columns="3" layout="grid" styleClass="ui-panelgrid-blank">
                <p:outputLabel for="termoPesquisa" value="Nome do Bem:"/>
                <p:inputText id="termoPesquisa" value="#{bemBean.termoPesquisa}" />
                <p:commandButton value="Pesquisar" actionListener="#{bemBean.pesquisar}" process="@this termoPesquisa" update="formBens:tabelaBens"/>
            </p:panelGrid>
        </p:panel>

        <p:dataTable id="tabelaBens" var="bem" value="#{bemBean.bens}" paginator="true" rows="10" emptyMessage="Nenhum bem encontrado com o critério de pesquisa informado.">
            <p:column headerText="ID" sortBy="#{bem.id}"><h:outputText value="#{bem.id}" /></p:column>
            <p:column headerText="Nome" sortBy="#{bem.nomeProduto}"><h:outputText value="#{bem.nomeProduto}" /></p:column>
            <p:column headerText="Tipo" sortBy="#{bem.tipoProduto.nome}"><h:outputText value="#{bem.tipoProduto.nome}" /></p:column>
            <p:column headerText="Preço de Compra" sortBy="#{bem.precoCompra}">
                <h:outputText value="#{bem.precoCompra}">
                    <f:convertNumber type="currency" currencySymbol="R$ "/>
                </h:outputText>
            </p:column>
            <p:column headerText="Depreciação Anual">
                <h:outputText value="#{bem.depreciacaoAnual}">
                    <f:convertNumber type="currency" currencySymbol="R$ "/>
                </h:outputText>
            </p:column>
            <p:column headerText="Ações" style="width:100px; text-align: center">
                <p:commandButton icon="pi pi-pencil" actionListener="#{bemBean.editar(bem)}" process="@this" update="@form" styleClass="rounded-button ui-button-warning"/>
                <p:commandButton icon="pi pi-trash" actionListener="#{bemBean.remover(bem)}" process="@this" update="formBens:tabelaBens formBens:messages" styleClass="rounded-button ui-button-danger">
                    <p:confirm header="Confirmação" message="Deseja realmente remover este bem?" icon="pi pi-exclamation-triangle"/>
                </p:commandButton>
            </p:column>
        </p:dataTable>

        <p:confirmDialog global="true">
            <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" />
            <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no ui-button-secondary" />
        </p:confirmDialog>
    </h:form>
</h:body>
</html>